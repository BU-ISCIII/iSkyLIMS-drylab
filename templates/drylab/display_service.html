{% extends 'drylab/base.html' %}
{% load static %}

{% block content %}
{% csrf_token %}
{% if display_service %} 
{% load mptt_tags %}
{% load l10n %}
    <h1><div class="color-heading">Service Information for the service {{ display_service.service_name}}</div></h1>
    <div class="row row-space-2 margin-b-4">
        <div class="col-sm-6">  <!-- general information from service -->
            <div class="panel panel-default">
              <div class="panel-heading">Service requested information</div>
              <div class="panel-body">
                  <table class="table table-hover">
                       <tbody>
                         <tr>
                           <td>Service Requested by:  </td>
                           <td> {{ display_service.user_name }} </td>
                         </tr>
                           <td>Service is in State:  </td>
                           <td> {{ display_service.state }} </td>
                         </tr>
                         </tr>
                           <td>File uploaded for the service:  </td>
                           <td><a href="/{{ display_service.file }}" download> File used  <span class="glyphicon glyphicon-download-alt"></span></a></td>
                         </tr>
                         {% for text, value in display_service.service_dates %}
                            <tr>
                                <td>{{ text }}</td>
                                <td>{{ value }}</td>
                            </tr>
                         {% endfor%}
                       </tbody>
                    </table>
                </div> <!--// end panel body -->
            </div> <!--// end panel -->
        </div> <!--// end col-sm-6  general information from service  -->
    <div class="row row-space-2 margin-b-4">
        <div class="col-sm-5 col-sm-offset-1">  <!-- Projects Requested services -->
            <div class="panel panel-default">
              <div class="panel-heading">Projects requested in the service</div>
              <div class="panel-body">
                  <table class="table table-hover">
                       <tbody>
                          {% for key, value in display_service.projects.items %}  
                             <tr>
                               <td><a href="/wetlab/search_project={{ key }}">{{ value }}</a> </td>
                             </tr>
                          {% endfor %}   
                       </tbody>
                    </table>
                </div> <!--// end panel body -->
            </div> <!--// end panel -->
        </div> <!--// end col-sm-5  Projects Requested services  -->
    </div> <!--// end row --> 
    <div class="row row-space-2 margin-b-4">
        <div class="col-sm-6">  <!-- Requested Services -->
            <div class="panel panel-default">
              <div class="panel-heading">Requested Services for {{ display_service.service_name}}</div>
              <div class="panel-body">
                  <ul class="root">
                    {% recursetree display_service.nodes %}
                        <li>
                            {{ node }} 
                            {% if not node.is_leaf_node %}
                                <ul class="children">
                                    {{ children }}
                                </ul>
                                <BR>
                            {% endif %}
                        </li>
                    {% endrecursetree %}
                  </ul>
                </div> <!--// end panel body -->
            </div> <!--// end panel -->
        </div> <!--// end col-sm-6  Requested Services  -->
        <div class="col-sm-5 col-sm-offset-1 ">  <!-- Actions  allowed-->
            <div class="panel panel-default">
              <div class="panel-heading">Allowed actions on  {{ display_service.service_name}}</div>
              <div class="panel-body">
                  {% if display_service.allowed_action_appr_reject %}
                    <form method="post" enctype="multipart/form-data" name="updateServiceState" id="updateServiceState" class="form-horizontal well">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="action_appr_reject"/>
                        <div class="form-group"> 
                            <div class="form-check form-check-inline">
                                  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="accepted">
                                  <label class="form-check-label" for="inlineRadio1">Accept Service</label>
                            </div>
                            <div class="form-check form-check-inline">
                                  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="rejected">
                                  <label class="form-check-label" for="inlineRadio2">Reject Service</label>
                            </div>
                           
                            <input class="btn pull-right btn-primary" type="submit" value="Submit">
                    </form>
                  {%elif display_service.allowed_action_queued %}
                     <form method="post" enctype="multipart/form-data" name="updateServiceState" id="updateServiceState" class="form-horizontal well">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="action_queued"/>
                        <div class="form-group"> 
                            <div class="form-check">
                                  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="queued">
                                  <label class="form-check-label" for="inlineRadio1">Queued the  Service</label>
                            </div>                          
                            <input class="btn pull-right btn-primary" type="submit" value="Submit">
                    </form>   
                  {% endif%}
                </div> <!--// end panel body -->
            </div> <!--// end panel -->
        </div> <!--// end col-sm-5  Actions  allowed  -->
    </div> <!--// end row -->
{% endif %}
{% endblock %}
